%YAML 1.2
%TAG !strict! tag:https://lnp-bp.org/lnp/strict.yaml
%TAG !wallet! tag:https://lnp-bp.org/lnp/wallet.yaml
---
name: keyring
type: RPC
desctiption: RPC API for Keyring service by Pandora Core
author: Dr Maxim Orlovsky <orlovsky@pandoracore.com>
---

types:
  id: !core!u16

  second_auth_factor: !!u32
    max: 999999

  key:
    - id: !id
    - xpubkey: !wallet!xpubkey
    - path: !wallet!derivation_path
    - fingerprint: !wallet!key_fingerprint

version:
  - features: 0

    messages:
      &ok 1:

      &error 0:
        - errtype: !!u16
        - info: !strict!utf8
            max: 256

      # Requests key listing
      &keys 1000:

      # Returned key list
      &keylist 1001:
        - acconts: !strict!array
            item: !key
            max: 1024

      # Generates a new seed & extended master private key
      &seed 2000:
        - auth: !second_auth_factor

      &export 2100:
        - key_id: !id
        - auth: !second_auth_factor

      &xpriv 2101:
        - xpriv: !wallet!xpriv

      &xpub 2102:
        - xpub: !wallet!xpub

      &derive 3000:
        - from: !id
        - derive_path: !wallet!derivation_path
        - auth: !second_auth_factor

    extensions:
      # No TLV extensions are defined

rpc:
  # Responses returning either ok or error
  - requests:
      - &seed
      - &derive
    responses:
      - &ok
      - &error

  - request: &keys
    responses: 
      - &error 
      - &keylist
...
